# R6522 移植・統合メモ

## 実装状況
- `jr100emu.via.r6522.R6522` にて Java 版 `jp.asamomiji.emulator.device.R6522` のロジックを写経し、タイマ・シフトレジスタ・IRQ・ポート入出力を再現。
- `jr100emu.jr100.r6522.JR100R6522` で JR-100 向けフックを移植し、フォント切替、キーマトリクス読取、サウンド出力、PB7/PB6 ジャンパ処理を実装。
- `jr100emu.jr100.display` / `keyboard` / `sound` / `hardware` として表示・キーボード・サウンド・ハードウェア束を整備し、VIA から呼び出されるインターフェースを用意。

## 確認内容
- `tests/unit/test_r6522.py` のテストで以下を検証。
  - タイマ1 (ACR=0xC0) による PB7 トグルと T1 IRQ の発生。
  - タイマ2 のタイムドモード / パルスカウントモードでの IRQ 変化。
  - JR-100 表示デバイスへのフォント切替通知、キーマトリクスからの入力反映、サウンド周波数キャッシュ処理。

## 今後の課題
- 実機ハードウェア接続 (ディスプレイ/キーボード/サウンド) クラスの実装と結線確認を進める。
- シフトレジスタの mode0 (シリアル外部クロック) 等、未カバレッジ部分のテストを追加検討。
